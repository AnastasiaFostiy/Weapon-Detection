# Weapon Detection FastAPI Web Service

Приложение для распознавания объектов на изображениях и коротких видеороликах (желательно до 5 секунд). Поддерживается веб-интерфейс на HTML5, где пользователь может загрузить файл и получить визуализированные предсказания. Модель обучена детектировать два класса:

-  **Knife**
-  **Handgun**

Примеры распознанных классов на изображениях и видео представлены в папке runs/result.
---

## Используемые технологии

- **FastAPI**
- **HTML**
- **YOLOv8** — предобученная модель `yolov8x.pt`, дообученная на специфичном датасете
- **Weapon Detection Dataset for YOLOv5** — набор данных для обучения

---

##  Установка

git clone https://github.com/<your-repo>/weapon-detection-api

cd weapon-detection-api

python -m venv venv

source venv/bin/activate

pip install -r requirements.txt

---

##  Запуск

uvicorn main:app --reload

Открой http://localhost:8000 в браузере.

---

##  Возможности

— Загрузка изображений (JPEG, PNG, WEBP)

— Загрузка видео (MP4, MOV) — рекомендуется короткие клипы

— Отображение результата прямо в браузере: размеченное изображение или встроенное видео

— Простое логгирование и сохранение результатов

---

##  Результаты обучения YOLOv8

Модель обучалась на ~50 эпохах на Weapon Detection Dataset for YOLOv5, который преимущественно содержит изображения оружия в руках. Использовалась предобученная yolov8x.pt.

###  Выводы по метрикам:

Метрики демонстрируют стабильный рост и выход на плато к эпохе ~40–45.
mAP@50 достиг 0.65+, но mAP@50–95 остаётся ниже 0.35 → модель слабо различает объекты сложных масштабов и контуров.
Precision и Recall находятся в диапазоне 0.60–0.70, что указывает на разумную уверенность, но не идеальную точность.

---

##  Ограничения модели

Модель иногда не распознаёт объекты, особенно:

— если нож или пистолет не находятся в руках

— если в руках человека другой предмет (телефон, инструмент и т.д.)

Это связано с предвзятостью обучающего набора: он в основном содержит изображения оружия в руках, мало примеров на столах, полу, в кобуре и прочих контекстах.

---

##  Возможные улучшения:

1. Дообучить модель на более разнообразных примерах:
2. 
— оружие без взаимодействия с человеком

— контексты: рюкзаки, столы, сумки, пол.
2. Увеличить количество эпох (например, до 100), чтобы стабилизировать mAP@50–95.
3. Интегрировать W&B / TensorBoard для более наглядного отслеживания метрик.
4. Добавить выбор классов через фронтенд и автосохранение результатов.